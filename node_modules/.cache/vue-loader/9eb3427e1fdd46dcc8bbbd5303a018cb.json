{"remainingRequest":"/Users/yang77/Desktop/h5-exam/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/yang77/Desktop/h5-exam/src/views/ExamDetails.vue?vue&type=style&index=0&id=4b28eb4b&lang=less&scoped=true&","dependencies":[{"path":"/Users/yang77/Desktop/h5-exam/src/views/ExamDetails.vue","mtime":1585400620171},{"path":"/Users/yang77/Desktop/h5-exam/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yang77/Desktop/h5-exam/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/yang77/Desktop/h5-exam/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/yang77/Desktop/h5-exam/node_modules/less-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yang77/Desktop/h5-exam/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yang77/Desktop/h5-exam/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKLmV4YW0tZGV0YWlscyB7CiAgLnRpdGxlIHsKICAgIGZvbnQtc2l6ZTogMThweDsKICAgIHRleHQtYWxpZ246IGNlbnRlcjsKICB9CiAgLmNvdW50LWRvd24gewogICAgbWFyZ2luOiAxMHB4OwogICAgdGV4dC1hbGlnbjogcmlnaHQ7CiAgfQogIC5kZXNjcmlwdGlvbiB7CiAgICBtYXJnaW46IDAgMCAyMHB4IDA7CiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7CiAgfQogIC5jb250ZW50IHsKICAgIC5leGFtLWl0ZW0gewogICAgICBtYXJnaW46IDEycHg7CiAgICB9CiAgfQogIC5zdWJtaXQgewogICAgbWFyZ2luOiA1MHB4IDAgNDBweCAwOwogIH0KfQo="},{"version":3,"sources":["ExamDetails.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2HA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ExamDetails.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <div class=\"exam-details\">\n    <div class=\"title\">\n      {{ examName }}\n    </div>\n    <div class=\"count-down\">\n      剩余时间:<nut-countdown  @on-end=\"onEnd\" :startTime=\"endTime\"></nut-countdown>\n    </div>\n    <div class=\"description\">\n      单项选择题，每题5分，多选，错选均不得分，20题，共计100分\n    </div>\n    <div class=\"content\">\n      <div class=\"exam-item\" v-for=\"(item, index) in topicList\" :key=\"index\">\n        <div class=\"topic\">{{ index + 1 }}.{{ item.question }}</div>\n        <nut-radiogroup v-model=\"item.stuAnswer\">\n          <div>\n            <nut-radio label=\"A\">A:{{ item.a }}</nut-radio>\n          </div>\n          <div>\n            <nut-radio label=\"B\">B.{{ item.b }}</nut-radio>\n          </div>\n          <div>\n            <nut-radio label=\"C\">C.{{ item.c }}</nut-radio>\n          </div>\n          <div>\n            <nut-radio label=\"D\">D.{{ item.d }}</nut-radio>\n          </div>\n        </nut-radiogroup>\n      </div>\n    </div>\n    <div class=\"submit\">\n      <nut-button block shape=\"circle\" @click=\"submit\">\n        提交试卷\n      </nut-button>\n    </div>\n  </div>\n</template>\n\n<script>\nexport default {\n  data() {\n    return {\n      stuId: null,\n      examName: null,\n      endTime: new Date().getTime() + 30 * 60 * 1000,\n      topicList: []\n    }\n  },\n  computed: {\n  },\n  mounted() {\n    this.examName = this.$route.query.examName\n    this.stuId = localStorage.getItem('stuId')\n    document.title = this.examName\n    this.startExam(this.examName)\n    this.getExamList()\n  },\n  methods: {\n    getExamList() {\n      this.$ajax.get(`/hmu/getPaperByExam/${this.examName}`).then(res => {\n        if (res.result === 0) {\n          this.topicList = res.data.select.questions\n        } else {\n          this.$toast.text(res.errMsg)\n        }\n      })\n    },\n    startExam(examName) {\n      this.$ajax.get(`/hmu/getTime/${examName}/${this.stuId}`).then(res => {\n        if (res.result === 0) {\n          let time = res.data.during\n          let str = parseInt(time / 60)\n            str += '分'\n            str += time % 60\n            str += '秒'\n          if (time < -1800) {\n            this.$toast.text('考试已结束')\n          }\n          console.log(str)\n          this.endTime = new Date().getTime() + 30 * 60 * 1000 + time\n          console.log(new Date().getTime(), this.endTime);\n        } else {\n          this.$toast.text(res.errMsg)\n        }\n      })\n    },\n    submit() {\n      let postData = {\n        score: 0,\n        answer: [],\n        questionId: [],\n        isRight: [],\n        stuId: this.stuId,\n        examName: this.examName\n      }\n      this.topicList.forEach(item => {\n        postData.answer.push(item.stuAnswer)\n        postData.questionId.push(item.questionId)\n        if (item.rightAnswer === item.stuAnswer) {\n          postData.score += 5\n          postData.isRight.push(1)\n        } else {\n          postData.isRight.push(0)\n        }\n      })\n      postData = JSON.stringify(postData);\n      this.$ajax.post(`/hmu/upload?param=${encodeURIComponent(postData)}`).then(res => {\n        if (res.result === 0) {\n          this.$toast.text('提交成功')\n          this.$router.push({ name: 'examlist'})\n        } else {\n          this.$toast.text(res.errMsg)\n        }\n      })\n    },\n    onEnd() {\n      console.log('ssss');\n    }\n  }\n}\n</script>\n\n<style lang=\"less\" scoped>\n.exam-details {\n  .title {\n    font-size: 18px;\n    text-align: center;\n  }\n  .count-down {\n    margin: 10px;\n    text-align: right;\n  }\n  .description {\n    margin: 0 0 20px 0;\n    text-align: center;\n  }\n  .content {\n    .exam-item {\n      margin: 12px;\n    }\n  }\n  .submit {\n    margin: 50px 0 40px 0;\n  }\n}\n</style>\n"]}]}